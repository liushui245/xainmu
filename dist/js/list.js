"use strict";jQuery(function(l){var c=document.querySelector(".center"),e=l("#shopping"),i=l(".shopping-left-gou");"true"==l.cookie("bluer")&&(l(".top-d1Top").css("display","none"),l(".top-d2Top").css("display","block").html("<em>hi,</em>\n            <span>"+l.cookie("name")+'</span>\n            <a href="#" id="exp">退出</a>\n            <a href="#">消息<i>5</i></a>\n            <a href="#">金币<i>50</i></a>'),p()),l("#exp").on("click",function(){l.cookie("bluer",null,{path:"/"}),l.cookie("user",null,{path:"/"}),l(".top-d2Top").css("display","none"),l(".top-d1Top").css("display","block").html('<span>欢迎来酒仙网!</span>\n            <a href="html/login.html">请登录</a>\n            <a href="html/register.html">免费注册</a>'),l("#Trolley").html(" "),l("#numshu").text("0")});var o="",d=parseInt(100*Math.random());function r(n,t,a,e,i){var s=new XMLHttpRequest,l=[200,304];s.onreadystatechange=function(){4==s.readyState&&-1!=l.indexOf(s.status)&&e(JSON.parse(s.responseText))},"get"==n?(s.open(n,t+a),s.send(null)):"post"==n&&(s.setRequestHeader("content-type","application/x-www-form-urlencoded"),s.open(n,t),s.send(a))}function p(){var n=l.cookie("user");l.ajax({type:"get",dataType:"json",url:"../api/gouwuche.php",data:{account:n},success:function(n){var i=n.data;l("#numshu").text(i.length),l("#Trolley").html(i.map(function(n){var t=n.quantity*n.price;return'<li class="gou-li" data-id=\''+n.daid+'\'>\n                                <div class="gou-tl">\n                                    <span class="gou-l">'+n.hotel+'</span>\n                                    <span class="gou-r">'+n.price+'</span>\n                                </div>\n                                <div class="gou-nr">\n                                    <div class="gou-nr-l1">\n                                        <img src="../'+n.imgpath+'" alt="'+n.title+'" />\n                                    </div>\n                                    <div class="gou-nr-l2">\n                                        <p title="'+n.title+'">'+n.title+'</p>\n                                    </div>\n                                    <div class="gou-nr-l3">\n                                        <button class="jian">-</button>\n                                        <span id>'+n.quantity+'</span>\n                                        <button class="jia">+</button>\n                                    </div>\n                                    <div class="gou-nr-l4">\n                                        <span>'+t+"</span>\n                                    </div>\n                                </div>\n                            </li>"})),l(".shopping-left").height(l(".shopping-right ul").height()),l(".jian").on("click",function(){var t=this,a=l(this),e=l(this).closest("li"),n=e.get(0).dataset.id;console.log(n),l.ajax({type:"get",dataType:"json",url:"../api/gouwucheadd.php",data:{key:"jian",dataid:n},success:function(n){console.log(n),console.log(l(t)),a.next().text(n.data),0==n.data&&(e.remove(),l("#numshu").text(i.length-1))}})}),l(".jia").on("click",function(){var t=this,a=l(this),e=l(this).closest("li"),n=e.get(0).dataset.id;l.ajax({type:"get",dataType:"json",url:"../api/gouwucheadd.php",data:{key:"jia",dataid:n},success:function(n){console.log(n),console.log(l(t)),a.prev().text(n.data),0==n.data&&e.remove()}})})}})}function u(n,t){t.innerText=n,t.style.display="block",setTimeout(function(){t.style.display="none"},2e3),window.onscroll=function(){console.log(scrollY),t.style.top=scrollY+200+"px"},t.style.top=scrollY+"px",t.style.left=(window.outerWidth-t.offsetWidth)/2+"px"}function n(n,t,a){e.animate({right:n},1e3,function(){l(this).stop(!0,!0)}),i.on("mouseover",function(){l(this).animate({right:0},1e3,function(){l(this).stop(!0,!0)}),e.animate({right:t},1e3,function(){l(this).stop(!0,!0)})}).on("click",function(){l(this).animate({right:a},1e3,function(){l(this).stop(!0)}),e.animate({right:0},1e3,function(){l(this).stop(!0,!0)})})}r("get","../api/list.php?conten=","5&qty=30&shu="+d+"&high="+o,function(n){var t="",s="";l("#listla").html(n.data.map(function(n){return n.href.slice(5),t=""!=n.pick?"zhenxuan":"",s=""!=n.label?'<span class="yh">'+n.label+"</span>":"",'<li data-id="'+n.daid+'" id="'+n.daid+'" style="z-index: 15;">\n                            <div class="content clearfix">\n                                <div class="collect_box">\n                                    <a class="img clearfix" href="#" title="'+n.title+'" target="_blank">\n                                        <img  src="../'+n.imgpath+'" alt="'+n.title+'" title="'+n.title+'">\n                                    </a>\n                                </div>\n                        \n                                <div class="priceArea clearfix">\n                                    <p class="price" >\n                                        ¥<span>'+n.price+'</span>\n                                    </p>\n                                </div>\n                                <div class="proName">\n                                    <a href="#" title="'+n.title+'" target="_blank">\n                                        <i class="'+t+'"></i>\n                                        '+n.title+'\n                                        <span class="slogan"></span>\n                                    </a>\n                                </div>\n                                <div class="judgeAdv clearfix">\n                                    <a class="judge" href="'+n.title+'" title="'+n.title+'" target="_blank">\n                                        <span>'+n.id+'</span>\n                                        评价\n                                    </a>\n                                </div>\n                                \n                                <div class="seller">\n                                </div>\n                                \n                                <div id="'+n.id+'" class="cuxiao">\n                                    <i class="projx sIcon"></i>\n                                    '+s+'\n                                </div>\n                                \n                                <div class="buyArea clearfix" id="'+n.id+'" style="">\n                                    <div class="edit">\n                                        <a class="decrease off" href="javascript:;">-</a>\n                                        <input type="text" gname="'+n.title+'" class="Textwen" value="1" name="">\n                                        <a class="increase" href="javascript:;">+</a>\n                                    </div>\n                                    <a class="cart sIcon prtlt_btn2 Gou" href="javascript:;">加入购物车</a>\n                                </div>\n                            \n                            </div>\n                        </li>'}).join("")),l("#paxc").on("click",function(){var t="",a="";r("get","../api/list.php?conten=","8&qty=30&shu="+d+"&high="+(o="desc"),function(n){l("#listla").html(n.data.map(function(n){return n.href.slice(5),t=""!=n.pick?"zhenxuan":"",a=""!=n.label?'<span class="yh">'+n.label+"</span>":"",'<li data-id="'+n.daid+'" id="'+n.daid+'" style="z-index: 15;">\n                                    <div class="content clearfix">\n                                        <div class="collect_box">\n                                            <a class="img clearfix" href="#" title="'+n.title+'" target="_blank">\n                                                <img  src="../'+n.imgpath+'" alt="'+n.title+'" title="'+n.title+'">\n                                            </a>\n                                        </div>\n                                \n                                        <div class="priceArea clearfix">\n                                            <p class="price" >\n                                                ¥<span>'+n.price+'</span>\n                                            </p>\n                                        </div>\n                                        <div class="proName">\n                                            <a href="#" title="'+n.title+'" target="_blank">\n                                                <i class="'+t+'"></i>\n                                                '+n.title+'\n                                                <span class="slogan"></span>\n                                            </a>\n                                        </div>\n                                        <div class="judgeAdv clearfix">\n                                            <a class="judge" href="'+n.title+'" title="'+n.title+'" target="_blank">\n                                                <span>'+n.id+'</span>\n                                                评价\n                                            </a>\n                                        </div>\n                                        \n                                        <div class="seller">\n                                        </div>\n                                        \n                                        <div id="'+n.id+'" class="cuxiao">\n                                            <i class="projx sIcon"></i>\n                                            '+a+'\n                                        </div>\n                                        \n                                        <div class="buyArea clearfix" id="'+n.id+'" style="">\n                                            <div class="edit">\n                                                <a class="decrease off" href="javascript:;">-</a>\n                                                <input type="text" gname="'+n.title+'" class="Textwen" value="1" name="">\n                                                <a class="increase" href="javascript:;">+</a>\n                                            </div>\n                                            <a class="cart sIcon prtlt_btn2 Gou" href="javascript:;">加入购物车</a>\n                                        </div>\n                                    \n                                    </div>\n                                </li>'}).join(""))})}),l("#asC").on("click",function(){r("get","../api/list.php?conten=","5&qty=30&shu="+d+"&high="+(o="asc"),function(n){var t="",a="";l("#listla").html(n.data.map(function(n){return n.href.slice(5),t=""!=n.pick?"zhenxuan":"",a=""!=n.label?'<span class="yh">'+n.label+"</span>":"",'<li data-id="'+n.daid+'" id="'+n.daid+'" style="z-index: 15;">\n                                    <div class="content clearfix">\n                                        <div class="collect_box">\n                                            <a class="img clearfix" href="#" title="'+n.title+'" target="_blank">\n                                                <img  src="../'+n.imgpath+'" alt="'+n.title+'" title="'+n.title+'">\n                                            </a>\n                                        </div>\n                                \n                                        <div class="priceArea clearfix">\n                                            <p class="price" >\n                                                ¥<span>'+n.price+'</span>\n                                            </p>\n                                        </div>\n                                        <div class="proName">\n                                            <a href="#" title="'+n.title+'" target="_blank">\n                                                <i class="'+t+'"></i>\n                                                '+n.title+'\n                                                <span class="slogan"></span>\n                                            </a>\n                                        </div>\n                                        <div class="judgeAdv clearfix">\n                                            <a class="judge" href="'+n.title+'" title="'+n.title+'" target="_blank">\n                                                <span>'+n.id+'</span>\n                                                评价\n                                            </a>\n                                        </div>\n                                        \n                                        <div class="seller">\n                                        </div>\n                                        \n                                        <div id="'+n.id+'" class="cuxiao">\n                                            <i class="projx sIcon"></i>\n                                            '+a+'\n                                        </div>\n                                        \n                                        <div class="buyArea clearfix" id="'+n.id+'" style="">\n                                            <div class="edit">\n                                                <a class="decrease off" href="javascript:;">-</a>\n                                                <input type="text" gname="'+n.title+'" class="Textwen" value="1" name="">\n                                                <a class="increase" href="javascript:;">+</a>\n                                            </div>\n                                            <a class="cart sIcon prtlt_btn2 Gou" href="javascript:;">加入购物车</a>\n                                        </div>\n                                    \n                                    </div>\n                                </li>'}).join(""))})});var a=Math.ceil(n.num/30);console.log(a),l("#numem").text(a);for(var e=1;e<=a;e++){var i=document.createElement("li");i.innerText=e,l("#fanyeU").get(0).appendChild(i)}l("#fanyeU").get(0).children[0].classList.add("on"),l("#listla").on("click",".increase",function(){var n=l(this).closest("li"),t=n.find(".Textwen").val();++t,n.find(".Textwen").val(t)}).on("click",".decrease",function(){var n=l(this).closest("li"),t=n.find(".Textwen").val();if(1==t)return!1;--t,n.find(".Textwen").val(t)}),l("#listla .Gou").on("click",function(){var n=l(this).closest("li"),t=n.find(".Textwen").val(),a=n.get(0).dataset.id,e=l.cookie("user"),i=l.cookie("bluer"),s=l(this).closest("li").find("img").attr("src");0==i||""==i||null==i?u("请先登录",c):(function(n,t,p){function u(n){return Math.pow(n,2)}var v=t.offsetLeft,h=t.offsetTop;console.log(v,h),function(n){console.log(n);var t=(n=n||event).clientX,a=n.clientY,e=t+(v-t)/2,i=document.createElement("img");document.body.appendChild(i),i.src=p,i.innerHTML="图片",i.style.position="fixed",i.style.left=t+"px",i.style.top=a+"px",i.style.zIndex=3e5,i.style.width="40px",i.style.height="40px";var s=(u(t)-u(e))*(h-a)-(u(v)-u(t))*(a-0),l=(u(t)-u(e))*(v-t)-(u(v)-u(t))*(t-e),c=s/l,o=(h-a-c*(v-t))/(u(v)-u(t)),d=h-o*u(v)-c*v,r=setInterval(function(){var n=o*u(t+=5)+c*t+d;i.style.left=t+"px",i.style.top=n+"px",v<=t&&(clearInterval(r),document.body.removeChild(i))},10)}()}(l(".Gou").get(0),l(".shopping-left-gou").get(0),s),l.ajax({type:"get",dataType:"json",url:"../api/gouwucheinto.php",data:{user:e,id:a,val:t},success:function(n){p(),console.log(n),u("添加购物车成功!",c)}}))}),l("#fanyeU li").on("click",function(){for(var n=window.scrollY,t=setInterval(function(){n-=10,window.scrollTo(0,n),window.scrollY<=50&&clearInterval(t)},1),a=l("#fanyeU li"),e=0;e<a.length;e++)l("#fanyeU").get(0).children[e].classList.remove("on");l(this).get(0).classList.add("on");var i=l(this).text();r("get","../api/list.php?conten=",i+"&qty=30&shu="+d+"&high="+o,function(n){l("#listla").html(n.data.map(function(n){if(n.href.slice(5),""!=n.pick)var t="zhenxuan";else var t="";return s=""!=n.label?'<span class="yh">'+n.label+"</span>":"",'<li data-id="'+n.daid+'" id="'+n.daid+'" style="z-index: 15;">\n                                    <div class="content clearfix">\n                                        <div class="collect_box">\n                                            <a class="img clearfix" href="#" title="'+n.title+'" target="_blank">\n                                                <img  src="../'+n.imgpath+'" alt="'+n.title+'" title="'+n.title+'">\n                                            </a>\n                                        </div>\n                                \n                                        <div class="priceArea clearfix">\n                                            <p class="price" >\n                                                ¥<span>'+n.price+'</span>\n                                            </p>\n                                        </div>\n                                        <div class="proName">\n                                            <a href="#" title="'+n.title+'" target="_blank">\n                                                <i class="'+t+'"></i>\n                                                '+n.title+'\n                                                <span class="slogan"></span>\n                                            </a>\n                                        </div>\n                                        <div class="judgeAdv clearfix">\n                                            <a class="judge" href="'+n.title+'" title="'+n.title+'" target="_blank">\n                                                <span>'+n.id+'</span>\n                                                评价\n                                            </a>\n                                        </div>\n                                        \n                                        <div class="seller">\n                                        </div>\n                                        \n                                        <div id="'+n.id+'" class="cuxiao">\n                                            <i class="projx sIcon"></i>\n                                            '+s+'\n                                        </div>\n                                        \n                                        <div class="buyArea clearfix" id="'+n.id+'" style="">\n                                            <div class="edit">\n                                                <a class="decrease off" href="javascript:;">-</a>\n                                                <input type="text" gname="'+n.title+'" class="Textwen" value="1" name="">\n                                                <a class="increase" href="javascript:;">+</a>\n                                            </div>\n                                            <a class="cart sIcon prtlt_btn2 Gou" href="javascript:;">加入购物车</a>\n                                        </div>\n                                    \n                                    </div>\n                                </li>'}).join(""))})}),l("#listla img").on("click",function(n){n.preventDefault();var t=l(this).closest("li"),a=t.get(0).dataset.id;location.href="detail.html?id="+a})}),e.outerHeight()<=window.innerHeight?n(-300,-265,265):n(-318,-282,282)});