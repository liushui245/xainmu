"use strict";jQuery(function(b){"true"==b.cookie("bluer")&&(b(".top-d1Top").css("display","none"),b(".top-d2Top").css("display","block").html("<em>hi,</em>\n            <span>"+b.cookie("name")+'</span>\n            <a href="#" id="exp">退出</a>\n            <a href="#">消息<i>5</i></a>\n            <a href="#">金币<i>50</i></a>'),j()),b("#exp").on("click",function(){b.cookie("bluer",!1,{path:"/"}),b.cookie("user",null,{path:"/"}),b(".top-d2Top").css("display","none"),b(".top-d1Top").css("display","block").html('<span>欢迎来酒仙网!</span>\n            <a href="html/login.html">请登录</a>\n            <a href="html/register.html">免费注册</a>'),b("#Trolley").html(" "),b("#numshu").text("0")});var t,e,n,i,o,a,s=location.search.slice(4);console.log(s),t="get",e="../api/goods.php?id=",n=s,i=function(t){console.log(t);var e=t.data[0].minimg.split('","'),n=t.data[0].maximg.split('","'),i=t.id.slice(6),o=t.data[0].comdetails.split('","');b("#srimg").html('<img src="../img/detail/'+e[0]+'">'),b("#maximgs").html('<img src="../img/detail/'+n[0]+'" style="left: -444px; top: -444px;">'),b("#listL").html(e.map(function(t){return'<li><img src="../img/detail/'+t+'" alt=""></li>'}).join("")),b("#infoImg").html(o.map(function(t){return'<div style="font-size:0;">\n                            <img src="../img/detail/'+t+'" alt="" usemap="#Map" border="0">\n                            </div>'}).join("")),b(".comName").html('<h1>\n                    <i class="zhenxuan"></i>\n                    '+t.data[0].title+"\n                </h1>\n                <p>"+t.data[0].label+"</p>"),b("#prce").html(t.data[0].price),b("#jias").on("click",function(){var t=b("#_nub").val();b("#_nub").val(++t)}),b("#jians").on("click",function(){var t=b("#_nub").val();2<=t?b("#_nub").val(--t):alert("不能小于一件")}),b("#addToCartForDetail").attr("data-id",t.id),b("#addToCartForDetail").on("click",function(){var t=b("#_nub").val(),e=b.cookie("user"),n=b(this).attr("data-id"),i=b.cookie("bluer");console.log(i),"false"==i?(alert("抱歉，请先登录!"),location.href="../html/login.html"):"true"==i&&(console.log(b("#srimg img").attr("src")),function(t,e,p){function d(t){return Math.pow(t,2)}var g=e.offsetLeft,m=e.offsetTop;console.log(g,m),function(t){console.log(t);var e=(t=t||event).clientX,n=t.clientY,i=e+(g-e)/2,o=document.createElement("img");document.body.appendChild(o),o.src=p,o.innerHTML="图片",o.style.position="fixed",o.style.left=e+"px",o.style.top=n+"px",o.style.zIndex=3e5,o.style.width="40px",o.style.height="40px";var a=(d(e)-d(i))*(m-n)-(d(g)-d(e))*(n-0),s=(d(e)-d(i))*(g-e)-(d(g)-d(e))*(e-i),l=a/s,c=(m-n-l*(g-e))/(d(g)-d(e)),r=m-c*d(g)-l*g,u=setInterval(function(){var t=c*d(e+=5)+l*e+r;o.style.left=e+"px",o.style.top=t+"px",g<=e&&(clearInterval(u),document.body.removeChild(o))},10)}()}(b("#addToCartForDetail").get(0),b(".shopping-left-gou").get(0),b("#srimg img").attr("src")),b.ajax({type:"get",dataType:"json",url:"../api/gouwucheinto.php",data:{user:e,id:n,val:t},success:function(t){j()}}))});var l=document.querySelector(".magnify-box"),a=document.querySelector(".min-img"),s=document.querySelector(".min-img img"),c=document.querySelector(".mask"),r=document.querySelector(".max-img"),u=document.querySelector(".max-img img"),p=document.querySelectorAll(".img-list li"),d="",g="",g="",m="",h="",f="",y="",v="",x="";a.onmouseenter=function(){c.style.display="block",r.style.display="block",d=c.offsetHeight,g=c.offsetWidth,m=a.offsetWidth,h=a.offsetHeight,v=r.offsetHeight,f=r.offsetWidth,y=u.offsetHeight,x=u.offsetWidth},a.onmousemove=function(t){var e=t.clientX-l.offsetLeft-g/2,n=t.clientY-l.offsetTop-d/2,i=m-g,o=h-d;i<e&&(e=i),o<n&&(n=o),e<=0&&(e=0),n<=0&&(n=0);var a=(x-f)/i,s=(y-v)/o;c.style.left=e+"px",c.style.top=n+"px",u.style.left=-e*a+"px",u.style.top=-n*s+"px"},a.onmouseleave=function(){c.style.display="none",r.style.display="none"},p.forEach(function(t,e){p[e].onmouseover=function(){for(var t=0;t<p.length;t++)p[t].classList.remove("on");this.classList.add("on"),s.src="../img/detail/"+i+"min"+(e+1)+".jpg",u.src="../img/detail/"+i+"max"+(e+1)+".jpg"}})},o=new XMLHttpRequest,a=[200,304],o.onreadystatechange=function(){4==o.readyState&&-1!=a.indexOf(o.status)&&i(JSON.parse(o.responseText))},"get"==t?(o.open(t,e+n),o.send(null)):"post"==t&&(o.setRequestHeader("content-type","application/x-www-form-urlencoded"),o.open(t,e),o.send(n));var l=b("#shopping"),c=b(".shopping-left-gou");function r(t,e,n){l.animate({right:t},1e3,function(){b(this).stop(!0,!0)}),c.on("mouseover",function(){b(this).animate({right:0},1e3,function(){b(this).stop(!0,!0)}),l.animate({right:e},1e3,function(){b(this).stop(!0,!0)})}).on("click",function(){b(this).animate({right:n},1e3,function(){b(this).stop(!0)}),l.animate({right:0},1e3,function(){b(this).stop(!0,!0)})})}function j(){var t=b.cookie("user");b.ajax({type:"get",dataType:"json",url:"../api/gouwuche.php",data:{account:t},success:function(t){var o=t.data;b("#numshu").text(o.length),b("#Trolley").html(o.map(function(t){var e=t.quantity*t.price;return'<li class="gou-li" data-id=\''+t.daid+'\'>\n                                <div class="gou-tl">\n                                    <span class="gou-l">'+t.hotel+'</span>\n                                    <span class="gou-r">'+t.price+'</span>\n                                </div>\n                                <div class="gou-nr">\n                                    <div class="gou-nr-l1">\n                                        <img src="../'+t.imgpath+'" alt="'+t.title+'" />\n                                    </div>\n                                    <div class="gou-nr-l2">\n                                        <p title="'+t.title+'">'+t.title+'</p>\n                                    </div>\n                                    <div class="gou-nr-l3">\n                                        <button class="jian">-</button>\n                                        <span id>'+t.quantity+'</span>\n                                        <button class="jia">+</button>\n                                    </div>\n                                    <div class="gou-nr-l4">\n                                        <span>'+e+"</span>\n                                    </div>\n                                </div>\n                            </li>"})),b(".shopping-left").height(b(".shopping-right ul").height()),b(".jian").on("click",function(){var e=this,n=b(this),i=b(this).closest("li"),t=i.get(0).dataset.id;console.log(t),b.ajax({type:"get",dataType:"json",url:"../api/gouwucheadd.php",data:{key:"jian",dataid:t},success:function(t){console.log(t),console.log(b(e)),n.next().text(t.data),0==t.data&&(i.remove(),b("#numshu").text(o.length-1))}})}),b(".jia").on("click",function(){var e=this,n=b(this),i=b(this).closest("li"),t=i.get(0).dataset.id;b.ajax({type:"get",dataType:"json",url:"../api/gouwucheadd.php",data:{key:"jia",dataid:t},success:function(t){console.log(t),console.log(b(e)),n.prev().text(t.data),0==t.data&&i.remove()}})})}})}l.outerHeight()<=window.innerHeight?r(-300,-265,265):r(-318,-282,282)});