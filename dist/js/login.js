"use strict";jQuery(function(u){var n=document.querySelector(".center"),o=[];a(o),shoujihao=!1,yzm=!1,u("#canvas").on("click",function(){a(o)});var e=/^1\d{10}$/;function s(o,e){e.innerText=o,e.style.display="block",setTimeout(function(){e.style.display="none"},2e3),e.style.left=(window.innerWidth-e.offsetWidth)/2+"px",e.style.top=(window.innerHeight-e.offsetHeight)/2+"px"}function t(o,e,t){o.next().next().css({display:"block",backgroundColor:"#CCC"}).text(e),o.css({border:"1px solid #ff6666"}),null!=t&&o.next().css({display:"none"})}function a(o){var e=u("#canvas").width(),t=u("#canvas").height(),n=document.getElementById("canvas"),s=n.getContext("2d");n.width=e,n.height=t;for(var a="a,b,c,d,e,f,g,h,i,j,k,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G,H,J,K,L,M,N,P,Q,R,S,T,W,X,Y,Z,1,2,3,4,5,6,7,8,9,0".split(","),i=a.length,l=0;l<4;l++){var r=Math.floor(Math.random()*i),c=Math.random()-.5,d=a[r];o[l]=d.toLowerCase();var h=10+20*l,p=20+8*Math.random();s.font="bold 23px 微软雅黑",s.translate(h,p),s.rotate(c),s.fillStyle=f(),s.fillText(d,0,0),s.rotate(-c),s.translate(-h,-p)}for(l=0;l<=5;l++)s.strokeStyle=f(),s.beginPath(),s.moveTo(Math.random()*e,Math.random()*t),s.lineTo(Math.random()*e,Math.random()*t),s.stroke();for(l=0;l<=30;l++){s.strokeStyle=f(),s.beginPath();h=Math.random()*e,p=Math.random()*t;s.moveTo(h,p),s.lineTo(h+1,p+1),s.stroke()}}function f(){return"rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")"}u("#tologin-d1").on("focus",function(){t(u(this),"请输入11位手机号码",!0)}).on("blur",function(){var o=function(o,e,t){{if(o.test(e.val()))return console.log(e.val()),e.next().next().css("display","none"),e.css({border:"1px solid #CCC"}),!0;e.next().next().css({display:"block",backgroundColor:"#ed787f"}).text(t),e.css({border:"1px solid #ff6666"}),e.next().css({display:"block"})}}(e,u(this),"请输入正确手机号码");shoujihao=1==o}),u("#tologin-d3").on("focus",function(){t(u(this),"输入验证码")}).on("blur",function(){u(this).val().toLowerCase()==o.join("")?(yzm=!0,console.log(yzm),u(this).next().next().css("display","none"),u(this).css({border:"1px solid #CCC"})):(yzm=!1,console.log(yzm),u(this).next().next().css({display:"block",backgroundColor:"#ed787f"}).text("请输入正确的验证码"),u(this).css({border:"1px solid #ff6666"}),u(this).next().css({display:"block"}))}),u("#tobtn").on("click",function(){var e=u("#tologin-d1").val(),t=u("#tologin-d2").val();a(o),1==shoujihao&&""!=t&&1==yzm?u.ajax({type:"post",dataType:"json",url:"../api/denglu.php",data:{user:e,pass:t},success:function(o){console.log(o),0<o.num?(u.cookie("user",e,{expires:1,path:"/"}),u.cookie("pass",t,{expires:1,path:"/"}),u.cookie("name",o.data[0].sole,{expires:1,path:"/"}),u.cookie("bluer",!0,{expires:1,path:"/"}),location.href="../index.html"):s("账号密码有误，请检查",n),1==u("#check").get(0).checked?(u.cookie("userl",e,{expires:1,path:"/"}),u.cookie("passl",t,{expires:1,path:"/"}),u.cookie("namel",o.data[0].sole,{expires:1,path:"/"}),u.cookie("bluer",!0,{expires:1,path:"/"})):(u.cookie("userl",null,{expires:1,path:"/"}),u.cookie("passl",null,{expires:1,path:"/"}),u.cookie("namel",null,{expires:1,path:"/"}))}}):s("请检查用户名或密码",n)})});